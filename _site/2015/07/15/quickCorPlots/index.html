<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/main.css">
    <title>Sam Buckberry</title>
</head>
<body>
    <main>
        <header class="site-header">
            <h1 class="site-title"><a href="/">Sam Buckberry</a></h1>
            <nav class="site-nav">
                <a href="/about/" class="">About</a>
                <a href="/publications/" class="">Publications</a>
                <a href="/cv/" class="">CV</a>
                <!--
                <a href="/recipes/" class="">[R]ecipes</a>
                -->

            </nav>
        </header>
        <article class="post">
    <h2 class="post-header">A function for quickly plotting a correlation scatter with R-squared and P-values</h2>
    <p class="post-meta">2015-07-15</p>
    <center>![](/images/corPlots/corPlot1-1.png)</center>

<h4 id="the-annotated-scatter-function">The annotated scatter function:</h4>

<p>```r
plotAnnotatedScatter &lt;- function(x, y, pointCol=rgb(0,0,0,0.7), 
                                 legendPos=”topleft”, legendCex=1, … ){
        # Generate a linear model summary
        fit &lt;- lm(y ~ x)
        fitSum &lt;- summary(fit)
        r2 &lt;- fitSum$r.squared
        pVal &lt;- fitSum$coefficients[2,4]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    # Format the legend for r and p values
    rp &lt;- vector('expression',2)
    rp[1] &lt;- substitute(expression(italic(R)^2 == valueA), 
                        list(valueA = format(r2,dig=3)))[2]
    rp[2] &lt;- substitute(expression(italic(p) == valueB), 
                        list(valueB = format(pVal, digits = 2)))[2]
    
    # Plot the data
    plot(x, y, pch=19, cex=1.2, col=pointCol,...)
    
    # Add line for linear model fit
    abline(fit)
    
    # Add the legend
    legend(legendPos, legend = rp, bty = 'n', cex=legendCex) } ```
</code></pre>
</div>

<h4 id="first-generate-some-test-data">First, generate some test data</h4>

<p><code class="highlighter-rouge">r
x &lt;- rnorm(n=20, mean=7, sd=3)
y &lt;- x+rnorm(20)
</code></p>

<h4 id="view-the-plot">View the plot</h4>

<p><code class="highlighter-rouge">r
plotAnnotatedScatter(x, y)
</code></p>

<p><img src="/images/corPlots/corPlot1-1.png" alt="" /></p>

<h4 id="add-axis-labels">Add axis labels</h4>

<p><code class="highlighter-rouge">r
plotAnnotatedScatter(x, y, xlab="X variable", ylab="Y variable")
</code></p>

<p><img src="/images/corPlots/corPlot2-1.png" alt="" /></p>

<h4 id="change-point-colour">Change point colour</h4>

<p><code class="highlighter-rouge">r
plotAnnotatedScatter(x, y, pointCol="red")
</code></p>

<p><img src="/images/corPlots/corPlot3-1.png" alt="" /></p>

<h4 id="change-the-legend-font-size">Change the legend font size</h4>

<p><code class="highlighter-rouge">r
plotAnnotatedScatter(x, y, legendCex=0.7)
</code></p>

<p><img src="/images/corPlots/corPlot4-1.png" alt="" /></p>

<h4 id="change-legend-position">Change legend position</h4>

<p><code class="highlighter-rouge">r
plotAnnotatedScatter(x, y, legendPos="bottomright")
</code></p>

<p><img src="/images/corPlots/corPlot5-1.png" alt="" /></p>

<p>You can source this R function directly from Github Gist</p>

<p><code class="highlighter-rouge">r
source("https://gist.githubusercontent.com/SamBuckberry/a83ddd3535d0de4addf0/raw/81d5479decf5d510d02cc4c21653f33b53916b97/plotAnnotatedScatter.R")
</code></p>


    
    <!--<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Sam Buckberry</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.-->
</article>

    </main>
    
</body>

</html>
